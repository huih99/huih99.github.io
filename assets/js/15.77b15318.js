(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{235:function(s,t,a){s.exports=a.p+"assets/img/tsc.693f05af.png"},275:function(s,t,a){"use strict";a.r(t);var n=a(0),e=Object(n.a)({},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"nodejs中使用脚本命令时如何传参"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nodejs中使用脚本命令时如何传参","aria-hidden":"true"}},[s._v("#")]),s._v(" nodeJS中使用脚本命令时如何传参")]),s._v(" "),n("blockquote",[n("p",[s._v("在node环境中，无论我们是通过全局安装还是局部安装的一些可执行的脚本命令，在使用时，其本质都是通过node去执行一段js代码以完成相应的操作， 形如 node abc.js，而我们使用命令时，还可以给脚本传递参数，那么参数是如何处理的呢？")])]),s._v(" "),n("h2",{attrs:{id:"普通传参"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#普通传参","aria-hidden":"true"}},[s._v("#")]),s._v(" 普通传参")]),s._v(" "),n("p",[n("strong",[s._v("经反复测试， node处理脚本参数,除了第一个可执行的命令，以空格分割的任何字符串（除了一些shell的语法）都是参数，并且都被搜集到process.argv属性中：")])]),s._v(" "),n("blockquote",[n("p",[s._v("process.argv属性返回一个数组，这个数组包含了启动node进程时的命令行参数。第一个元素为启动node 进程的可执行文件的绝对路径名process.execPath，第二个元素为当前执行的JavaScript文件路径。剩余的元素为其他命令行参数。")])]),s._v(" "),n("p",[n("strong",[s._v("例：自定义脚本命令")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// scripts/myCommand.js")]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'argv'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("argv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("package.json中scripts命令：")]),s._v(" "),n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[s._v("    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"myCommand"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node myCommand.js --myName=tanhui mode=dev"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("现在执行myCommand命令，"),n("code",[s._v("npm run myCommand")]),s._v(",process.argv内容如下")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'C:\\\\Program Files\\\\nodejs\\\\node.exe'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'C:\\\\Users\\\\tanh\\\\Desktop\\\\app\\\\scripts\\\\myCommand.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--myName=sunwukong'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mode=dev'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[n("strong",[s._v("安装的依赖包提供的命令")])]),s._v(" "),n("p",[s._v("例如在写 "),n("code",[s._v("typescript")]),s._v("时常用到的一个命令"),n("code",[s._v("tsc")]),s._v(",安装 "),n("code",[s._v("typescript")]),s._v(" 依赖后会在node_modules的 "),n("code",[s._v(".bin")]),s._v("目录中创建一个软链接，指向可执行的脚本文件，这里就是 "),n("code",[s._v("tsc")]),s._v(" 命令：\n"),n("img",{attrs:{src:a(235),alt:"tsc"}})]),s._v(" "),n("p",[s._v("代码头部中 "),n("code",[s._v("#!/usr/bin/env node")]),s._v("指定的是当前这段代码的执行器为 "),n("strong",[s._v("node")])]),s._v(" "),n("p",[s._v("现在执行以下命令："),n("code",[s._v("tsc --no-emit --out-file main.js --outDir build")]),s._v(",其实本质相当于是执行了这个命令："),n("code",[s._v("node node_modules/typescript/lib/tsc.js --no-emit --out-file main.js --outDir build")]),s._v(",所以参数依然会被搜集到"),n("code",[s._v("process.argv")]),s._v("中。")]),s._v(" "),n("h2",{attrs:{id:"命令行传参"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#命令行传参","aria-hidden":"true"}},[s._v("#")]),s._v(" 命令行传参")]),s._v(" "),n("p",[s._v("还可以通过命令行传参的方式传递传参数,所谓的命令行传参即是指使用npm run 调用 package.json 中 "),n("code",[s._v("scripts")]),s._v(" 属性中定义的脚本命令时传递参数：")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("npm run myCommand "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("params  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 参数params将转化成process.env.npm_config_params = true")]),s._v("\nnpm run myCommand "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("params"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 参数params将转化成process.env.npm_config_params = 123")]),s._v("\nnpm run myCommand "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("params  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 等同于--params参数")]),s._v("\n\nnpm run myCommand "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("params  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 将--params参数添加到process.argv数组中")]),s._v("\nnpm run myCommand params  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 将params参数添加到process.argv数组中")]),s._v("\nnpm run myCommand "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" params  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 将params参数添加到process.argv数组中")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("使用命令行传参如果想将参数添加到"),n("code",[s._v("process.argv")]),s._v("中，一定要注意添加 "),n("code",[s._v("--")])]),s._v(" "),n("p",[n("strong",[s._v("需要注意的是，如果使用命令行传参，需要知道脚本中到底是怎么处理参数的，到底是使用 npm_config_xxx 这种形式的参数还是使用 process.argv 中的参数")])]),s._v(" "),n("h3",{attrs:{id:"使用yarn执行命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用yarn执行命令","aria-hidden":"true"}},[s._v("#")]),s._v(" 使用yarn执行命令")]),s._v(" "),n("p",[n("code",[s._v("yarn")]),s._v("执行命令与"),n("code",[s._v("npm run")]),s._v("有所不同，使用"),n("code",[s._v("yarn")]),s._v("执行的命令，其参数会被放进"),n("code",[s._v("process.argv")]),s._v("中，而不是"),n("code",[s._v("process.env.npm_config_xxx")])]),s._v(" "),n("p",[s._v("例：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("yarn run myCommand --port=8080\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("输出process.argv:")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'C:\\\\Program Files\\\\nodejs\\\\node.exe'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'C:\\\\Users\\\\tanh\\\\Desktop\\\\app\\\\scripts\\\\myCommand.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--port=8080'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[n("strong",[s._v("推荐使用process.argv作为脚本参数来源，可避免如使用yarn与使用 npm run 执行命令时参数传递的差异性")])]),s._v(" "),n("h2",{attrs:{id:"脚本文件内拿到当前正在执行的脚本命令的名称"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#脚本文件内拿到当前正在执行的脚本命令的名称","aria-hidden":"true"}},[s._v("#")]),s._v(" 脚本文件内拿到当前正在执行的脚本命令的名称")]),s._v(" "),n("p",[s._v("引自阮一峰老师的文章：")]),s._v(" "),n("blockquote",[n("p",[s._v("npm 提供一个"),n("code",[s._v("npm_lifecycle_event")]),s._v("变量，返回当前正在运行的脚本名称，比如pretest、test、posttest等等。所以，可以利用这个变量，在同一个脚本文件里面，为不同的npm scripts命令编写代码。")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TARGET")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("npm_lifecycle_event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TARGET")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("`Running the test task!`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TARGET")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pretest'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("`Running the pretest task!`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TARGET")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'posttest'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("`Running the posttest task!`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])])])},[],!1,null,null,null);t.default=e.exports}}]);